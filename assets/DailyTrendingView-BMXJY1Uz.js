import{_ as B,n as N,u as U,r as k,p as z,c as l,q as A,i as D,b as o,g as w,d as a,e as c,w as d,F as P,j as F,f as R,o as n,h as C,v as j,M as E}from"./index-7FuSJdjK.js";const G={class:"trending-page"},H={key:0,class:"loading"},J={key:1,class:"error"},K={key:2,class:"empty-list"},O={key:3,class:"trending-movies"},Q={class:"pagination"},W={__name:"DailyTrendingView",props:{page:{type:Number,default:1}},setup(M){const x=M,s=N(),p=U(),g=z(),S=R(),r=k(parseInt(g.query.page)||x.page),T=k(500),I=l(()=>s.loading),_=l(()=>s.error),v=l(()=>s.dailyTrending||[]),m=l(()=>p.isAuthenticated),y=l(()=>{var e;return(e=p.currentUser)==null?void 0:e.id}),L=e=>!m.value||!s.userMovieList.length?!1:s.userMovieList.some(t=>t.movieId.toString()===e.toString()),u=async()=>{try{await s.getDailyTrending(r.value),m.value&&y.value&&await s.getUserMovieList(y.value)}catch(e){console.error("获取热门电影失败:",e)}},V=e=>{r.value=e,S.replace({query:{...g.query,page:e}})};return A(r,()=>{u()}),D(()=>{u()}),(e,t)=>{const b=c("el-skeleton"),f=c("el-button"),h=c("el-empty"),q=c("el-pagination");return n(),o("div",G,[t[3]||(t[3]=w("h1",null,"今日热门电影",-1)),I.value?(n(),o("div",H,[a(b,{rows:20,animated:""})])):_.value?(n(),o("div",J,[a(h,{description:_.value,"image-size":200},{default:d(()=>[a(f,{type:"primary",onClick:u},{default:d(()=>t[1]||(t[1]=[C("重试")])),_:1,__:[1]})]),_:1},8,["description"])])):v.value.length===0?(n(),o("div",K,[a(h,{description:"暂无热门电影数据","image-size":200},{default:d(()=>[a(f,{type:"primary",onClick:u},{default:d(()=>t[2]||(t[2]=[C("刷新")])),_:1,__:[2]})]),_:1})])):(n(),o("div",O,[(n(!0),o(P,null,F(v.value,i=>(n(),j(E,{key:i.id,movie:i,"is-in-list":L(i.id)},null,8,["movie","is-in-list"]))),128))])),w("div",Q,[a(q,{"current-page":r.value,"onUpdate:currentPage":t[0]||(t[0]=i=>r.value=i),"page-size":20,layout:"prev, pager, next",total:T.value,onCurrentChange:V},null,8,["current-page","total"])])])}}},Y=B(W,[["__scopeId","data-v-76d59dc1"]]);export{Y as default};
